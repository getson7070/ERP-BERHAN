{% extends "base.html" %}
{% block title %}Add Tender{% endblock %}
{% block body %}
<div class="container py-5">
<div class="container mt-5">
        <h2>Add Tender</h2>
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
        <form method="POST" action="" class="needs-validation" novalidate>
            {{ form.hidden_tag() }}
            <div class="mb-3">
                <label for="tender_type_id" class="form-label">Tender Type</label>
                <select name="tender_type_id" id="tender_type_id" class="form-select" required>
                    {% for type in tender_types %}
                        <option value="{{ type['id'] }}">{{ type['type_name'] }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <input type="text" name="description" id="description" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="due_date" class="form-label">Due Date</label>
                <input type="date" name="due_date" id="due_date" class="form-control" required>
            </div>
            <div class="mb-3">
                <label for="institution" class="form-label">Institution</label>
                <input type="text" name="institution" id="institution" class="form-control">
            </div>
            <div class="mb-3">
                <label for="envelope_type" class="form-label">Envelope Type</label>
                <select name="envelope_type" id="envelope_type" class="form-select" required>
                    <option value="One Envelope">One Envelope</option>
                    <option value="Two Envelope">Two Envelope</option>
                </select>
            </div>
            <div class="mb-3" id="private_key_field">
                <label for="private_key" class="form-label">Private Key</label>
                <input type="text" name="private_key" id="private_key" class="form-control">
            </div>
             <div class="mb-3 d-none" id="tech_key_field">
                <label for="tech_key" class="form-label">Technical Key</label>
                <input type="text" name="tech_key" id="tech_key" class="form-control">
            </div>
             <div class="mb-3 d-none" id="fin_key_field">
                <label for="fin_key" class="form-label">Financial Key</label>
                <input type="text" name="fin_key" id="fin_key" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
            <a href="{{ url_for('main.dashboard') }}" class="btn btn-secondary ms-2">Back to Dashboard</a>
        </form>
    </div>
    <script nonce="{{ csp_nonce() }}">
          document.getElementById('envelope_type').addEventListener('change', function() {
              var privateKey = document.getElementById('private_key_field');
              var techKey = document.getElementById('tech_key_field');
              var finKey = document.getElementById('fin_key_field');
              if (this.value === 'One Envelope') {
                  privateKey.classList.remove('d-none');
                  techKey.classList.add('d-none');
                  finKey.classList.add('d-none');
              } else {
                  privateKey.classList.add('d-none');
                  techKey.classList.remove('d-none');
                  finKey.classList.remove('d-none');
              }
          });
    </script>
    <script nonce="{{ csp_nonce() }}" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</div>
{% endblock %}
