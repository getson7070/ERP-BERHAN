{% extends "base.html" %}
{% block title %}Customer Relationships{% endblock %}
{% block content %}
  <header class="page-header">
    <h1 class="page-title">Customer directory</h1>
    <p class="page-subtitle">Monitor every institution your sales team interacts with and keep contact records current.</p>
    <div class="button-grid">
      <a class="btn btn--secondary" href="{{ url_for('crm.add_customer') }}">Add customer</a>
      <a class="btn btn--ghost" href="{{ url_for('crm.export_customers_csv', sort=sort, dir=direction) }}">Export CSV</a>
      <a class="btn btn--ghost" href="{{ url_for('crm.export_customers_xlsx', sort=sort, dir=direction) }}">Export XLSX</a>
    </div>
  </header>
  <section aria-label="Customer list" class="table-section">
    {% if customers %}
      <div class="table-meta">
        <span>{{ customers|length }} result{{ customers|length != 1 and 's' or '' }} shown â€¢ Sorted by {{ sort }} {{ direction }}</span>
      </div>
      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th scope="col"><a href="{{ url_for('crm.index', sort='id', dir='asc' if sort != 'id' or direction == 'desc' else 'desc', limit=limit, offset=0) }}">ID</a></th>
              <th scope="col"><a href="{{ url_for('crm.index', sort='name', dir='asc' if sort != 'name' or direction == 'desc' else 'desc', limit=limit, offset=0) }}">Name</a></th>
            </tr>
          </thead>
          <tbody>
            {% for customer in customers %}
              <tr>
                <td data-title="ID">{{ customer.id }}</td>
                <td data-title="Name">{{ customer.name }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <nav class="pagination" aria-label="Customer list pagination">
        <span>Rows per page: {{ limit }}</span>
        <div class="pagination__actions">
          {% if prev_offset is not none %}
            <a class="btn btn--ghost" href="{{ url_for('crm.index', offset=prev_offset, limit=limit, sort=sort, dir=direction) }}">Previous</a>
          {% endif %}
          {% if next_offset is not none %}
            <a class="btn btn--ghost" href="{{ url_for('crm.index', offset=next_offset, limit=limit, sort=sort, dir=direction) }}">Next</a>
          {% endif %}
        </div>
      </nav>
    {% else %}
      <p class="empty-state">No customers recorded yet. Capture marketing visits and client onboarding to populate this list.</p>
    {% endif %}
  </section>
{% endblock %}
{% block head %}
  {{ super() }}
  <style>
    .table-section { margin-top: var(--space-lg); display: grid; gap: var(--space-md); }
    .table-meta { color: var(--text-muted); font-size: 0.95rem; }
    .table-responsive { border: 1px solid var(--border-subtle); border-radius: var(--radius-md); overflow-x: auto; }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { padding: var(--space-md); border-bottom: 1px solid var(--border-subtle); }
    .table tbody tr:last-child td { border-bottom: none; }
    .table a { color: inherit; text-decoration: none; }
    .table a:hover { text-decoration: underline; }
    .pagination { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--space-sm); }
    .pagination__actions { display: flex; gap: var(--space-sm); }
    .empty-state { padding: var(--space-lg); background: var(--layer-subtle); border-radius: var(--radius-md); text-align: center; color: var(--text-muted); }
  </style>
{% endblock %}
