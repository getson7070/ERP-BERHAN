{% extends "base.html" %}
{% block title %}Employee Login{% endblock %}
{% block content %}
  <header class="page-header">
    <h1 class="page-title">Employee sign in</h1>
    <p class="page-subtitle">Confirm your identity with password and MFA code.</p>
  </header>
  <form method="post" class="form-grid">
    {{ form.csrf_token }}
    <div class="form-field">
      {{ form.email.label(class_="form-label") }}
      {{ form.email(
        class_="form-input",
        autocomplete="username email",
        placeholder="you@berhan.com",
        aria_invalid="true" if form.email.errors else "false",
        aria_describedby=form.email.id ~ '-errors' if form.email.errors else None,
      ) }}
      {% if form.email.errors %}
        <ul class="form-errors" id="{{ form.email.id }}-errors">
          {% for error in form.email.errors %}
            <li class="form-error">{{ error }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
    <div class="form-field">
      {{ form.password.label(class_="form-label") }}
      {{ form.password(
        class_="form-input",
        type="password",
        autocomplete="current-password",
        placeholder="••••••••",
        aria_invalid="true" if form.password.errors else "false",
        aria_describedby=form.password.id ~ '-errors' if form.password.errors else None,
      ) }}
      {% if form.password.errors %}
        <ul class="form-errors" id="{{ form.password.id }}-errors">
          {% for error in form.password.errors %}
            <li class="form-error">{{ error }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
    <div class="form-field">
      {{ form.totp.label(class_="form-label") }}
      {% set totp_help_id = form.totp.id ~ '-help' %}
      {% set totp_error_id = form.totp.id ~ '-errors' %}
      {{ form.totp(
        class_="form-input",
        maxlength="6",
        inputmode="numeric",
        autocomplete="one-time-code",
        placeholder="123456",
        aria_invalid="true" if form.totp.errors else "false",
        aria_describedby=totp_help_id ~ (" " ~ totp_error_id if form.totp.errors else ""),
      ) }}
      <p class="form-help" id="{{ totp_help_id }}">Use the 6-digit code from your authenticator.</p>
      {% if form.totp.errors %}
        <ul class="form-errors" id="{{ totp_error_id }}">
          {% for error in form.totp.errors %}
            <li class="form-error">{{ error }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
    <div>
      {{ form.submit(class_="btn btn--primary btn--full") }}
    </div>
  </form>
  <div class="links links--center">
    <a class="link-muted" href="{{ url_for('auth.choose_login') }}">Back to role selection</a>
  </div>
{% endblock %}
