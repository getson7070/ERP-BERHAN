{% extends "base.html" %}
{% block title %}Inventory{% endblock %}
{% block content %}
  <header class="page-header">
    <h1 class="page-title">Inventory</h1>
    <p class="page-subtitle">Review stock levels, search by SKU, and export inventory snapshots.</p>
    <div class="button-grid">
      <a class="btn btn--ghost" href="{{ url_for('inventory_ui.export_inventory_csv', sku=sku, sort=sort, dir=direction) }}">Export CSV</a>
      <a class="btn btn--ghost" href="{{ url_for('inventory_ui.export_inventory_xlsx', sku=sku, sort=sort, dir=direction) }}">Export XLSX</a>
      <a class="btn btn--secondary" href="{{ url_for('receive_inventory.receive_form') }}">Receive inventory</a>
    </div>
  </header>
  <form method="get" class="filters" aria-label="Inventory filters">
    <div class="form-field">
      <label class="form-label" for="sku">Filter by SKU</label>
      <input id="sku" name="sku" class="form-input" value="{{ sku or '' }}" placeholder="SKU">
    </div>
    <div class="form-field">
      <label class="form-label" for="limit">Rows per page</label>
      <input id="limit" name="limit" class="form-input" type="number" value="{{ limit }}" min="5" max="100">
    </div>
    <button type="submit" class="btn btn--primary">Apply</button>
  </form>
  {% if items %}
    <div class="table-responsive">
      <table class="table">
        <thead>
          <tr>
            <th scope="col"><a href="{{ url_for('inventory_ui.inventory_table', sort='id', dir='asc' if sort != 'id' or direction == 'desc' else 'desc', sku=sku, limit=limit, offset=0) }}">ID</a></th>
            <th scope="col"><a href="{{ url_for('inventory_ui.inventory_table', sort='sku', dir='asc' if sort != 'sku' or direction == 'desc' else 'desc', sku=sku, limit=limit, offset=0) }}">SKU</a></th>
            <th scope="col"><a href="{{ url_for('inventory_ui.inventory_table', sort='name', dir='asc' if sort != 'name' or direction == 'desc' else 'desc', sku=sku, limit=limit, offset=0) }}">Name</a></th>
            <th scope="col"><a href="{{ url_for('inventory_ui.inventory_table', sort='quantity', dir='asc' if sort != 'quantity' or direction == 'desc' else 'desc', sku=sku, limit=limit, offset=0) }}">Quantity</a></th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
            <tr>
              <td data-title="ID">{{ item.id }}</td>
              <td data-title="SKU">{{ item.sku }}</td>
              <td data-title="Name">{{ item.name }}</td>
              <td data-title="Quantity">{{ item.quantity }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <nav class="pagination" aria-label="Inventory pagination">
      <span>Showing {{ items|length }} results</span>
      <div class="pagination__actions">
        {% if prev_offset is not none %}
          <a class="btn btn--ghost" href="{{ url_for('inventory_ui.inventory_table', offset=prev_offset, limit=limit, sku=sku, sort=sort, dir=direction) }}">Previous</a>
        {% endif %}
        {% if next_offset is not none %}
          <a class="btn btn--ghost" href="{{ url_for('inventory_ui.inventory_table', offset=next_offset, limit=limit, sku=sku, sort=sort, dir=direction) }}">Next</a>
        {% endif %}
      </div>
    </nav>
  {% else %}
    <p class="empty-state">No inventory items found.</p>
  {% endif %}
{% endblock %}
{% block head %}
  {{ super() }}
  <style>
    .filters { display: grid; gap: var(--space-md); margin-top: var(--space-lg); margin-bottom: var(--space-lg); }
    @media (min-width: 640px) { .filters { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); align-items: end; } }
    .table-responsive { border: 1px solid var(--border-subtle); border-radius: var(--radius-md); overflow-x: auto; }
    .table { width: 100%; border-collapse: collapse; }
    .table th, .table td { padding: var(--space-md); border-bottom: 1px solid var(--border-subtle); }
    .table th a { color: inherit; text-decoration: none; }
    .table th a:hover { text-decoration: underline; }
    .table tbody tr:last-child td { border-bottom: none; }
    .pagination { display: flex; justify-content: space-between; align-items: center; gap: var(--space-sm); margin-top: var(--space-md); flex-wrap: wrap; }
    .pagination__actions { display: flex; gap: var(--space-sm); }
    .empty-state { margin-top: var(--space-lg); padding: var(--space-lg); background: var(--layer-subtle); border-radius: var(--radius-md); text-align: center; color: var(--text-muted); }
  </style>
{% endblock %}
